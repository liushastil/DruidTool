# Druid Scanner Extension for Burp Suite

这是一个功能强大的 Burp Suite 扩展，专门用于扫描和监控 Apache Druid 数据库的信息。该扩展集成了 Druid 扫描器和会话监控功能，帮助安全研究人员和渗透测试人员深入了解 Druid 数据库的配置和活动。

## 🚀 主要功能

### Druid Scanner 模块
- **自动登录认证**：支持用户名/密码登录 Druid 管理界面
- **会话管理**：自动保存和验证登录会话，支持会话复用
- **多维度信息扫描**：
  - **JDBC 数据源信息**：数据库连接配置、用户名、JDBC URL
  - **会话信息监控**：实时监控活跃会话和会话变化
  - **SQL 查询记录**：获取历史 SQL 查询语句
  - **URI 访问记录**：监控 URI 访问路径和频率
  - **系统基本信息**：Java 版本、类路径、虚拟机信息

### Session Monitor 模块
- **实时会话监控**：从指定 URL 获取会话信息
- **智能搜索过滤**：支持实时搜索和过滤会话数据
- **数据对比分析**：对比不同时间点的会话变化
- **结果导出**：支持扫描结果导出

## 📋 系统要求

- **Java 版本**：Java 17 或更高版本
- **Burp Suite**：支持 Montoya API 的版本（推荐 2024.1+）
- **网络连接**：能够访问目标 Druid 实例

## 🛠️ 安装和使用

### 1. 构建扩展

```bash
# 在项目根目录执行
./gradlew jar
# 或 Windows 系统
gradlew.bat jar
```

### 2. 导入到 Burp Suite

1. 打开 Burp Suite
2. 进入 **Extensions > Installed** 标签页
3. 点击 **Add** 按钮
4. 选择 **Java** 类型
5. 选择生成的 JAR 文件：`build/libs/extension-template-project-1.0.0.jar`
6. 点击 **Next** 完成加载

### 3. 使用扩展

#### Druid Scanner 使用步骤：

1. **配置目标信息**：
   - **Target URL**：输入 Druid 管理界面地址（如：`http://example.com:8082`）
   - **Username**：Druid 管理员用户名
   - **Password**：Druid 管理员密码
   - **Headers**：可选的自定义请求头

2. **执行扫描**：
   - 点击 **Run** 按钮开始扫描
   - 系统会自动登录并获取所有 Druid 信息
   - 扫描结果会显示在对应的标签页中

3. **查看结果**：
   - **JDBC Info**：数据库连接配置信息
   - **Sessions**：当前活跃会话列表
   - **SQL Queries**：历史 SQL 查询记录
   - **URIs**：URI 访问记录
   - **Session Changes**：会话变化对比

4. **高级功能**：
   - **Test URL**：测试目标 URL 可访问性
   - **Update Data**：使用保存的会话更新数据
   - **Clear Session**：清除保存的会话
   - **Export Results**：导出扫描结果
   - **Clear History**：清除历史记录

#### Session Monitor 使用步骤：

1. 切换到 **Session Monitor** 标签页
2. 点击 **刷新** 按钮获取会话信息
3. 使用搜索框过滤特定会话
4. 查看实时会话数据

## 🔧 技术特性

### 核心功能
- **智能 URL 解析**：自动解析目标 URL，支持各种路径格式
- **会话持久化**：使用 ConcurrentHashMap 安全存储会话信息
- **异步处理**：使用 SwingWorker 避免 UI 阻塞
- **错误处理**：完善的异常处理和用户友好的错误提示
- **实时过滤**：支持实时搜索和过滤功能

### 安全特性
- **密码安全**：使用 JPasswordField 保护密码输入
- **会话验证**：自动验证会话有效性
- **请求头管理**：支持自定义请求头配置
- **代理支持**：预留代理配置接口

### 数据处理
- **JSON 解析**：使用 FastJSON2 高效解析响应数据
- **数据格式化**：美观的结果展示格式
- **变化检测**：智能检测会话变化并分类显示
- **导出功能**：支持结果导出为文本格式

## 📊 扫描结果说明

### JDBC 信息
- 数据库用户名
- JDBC 连接 URL
- Java 类路径
- Java 虚拟机信息
- Java 版本信息

### 会话信息
- 当前活跃会话 ID
- 会话状态和变化
- 新增/移除/未变化的会话

### SQL 查询记录
- 历史执行的 SQL 语句
- 查询频率统计
- 查询类型分析

### URI 访问记录
- 访问的 URI 路径
- 访问频率统计
- 访问模式分析

## 🚨 注意事项

### 使用建议
1. **权限确认**：确保有合法的权限访问目标 Druid 实例
2. **网络环境**：确保网络连接稳定，避免扫描中断
3. **会话管理**：定期清理过期的会话信息
4. **结果分析**：仔细分析扫描结果，识别潜在的安全风险

### 安全提醒
- 本工具仅用于授权的安全测试
- 请遵守相关法律法规和道德准则
- 不要对未授权的系统进行扫描
- 妥善保管获取的敏感信息

### 技术限制
- 需要目标 Druid 实例开启管理界面
- 需要有效的管理员凭据
- 某些功能可能受网络环境限制
- 大量数据时可能影响性能

## 🔄 更新日志

### v1.0.0
- 初始版本发布
- 支持基本的 Druid 信息扫描
- 集成会话监控功能
- 实现会话管理和变化检测

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request 来改进这个扩展：

1. Fork 本项目
2. 创建功能分支
3. 提交更改
4. 推送到分支
5. 创建 Pull Request

## 📄 许可证

本项目采用 MIT 许可证，详见 [LICENSE](LICENSE) 文件。

## 📞 支持与反馈

如果您在使用过程中遇到问题或有改进建议，请：

1. 查看 [Issues](../../issues) 页面
2. 提交新的 Issue
3. 加入我们的讨论社区

---

**免责声明**：本工具仅供安全研究和授权测试使用。使用者需要确保在合法和授权的范围内使用本工具，并承担相应的法律责任。
